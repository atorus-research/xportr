<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Deep Dive into xportr • xportr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deep Dive into xportr">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xportr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/xportr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/deepdive.html">Deep Dive into xportr</a></li>
    <li><a class="dropdown-item" href="../articles/agency_standards.html">Standards in Different Regulatory Agencies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/archives/C030EB2M4GM" aria-label="slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/atorus-research/xportr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="deepdive_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="deepdive_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="deepdive_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="deepdive_files/datatables-binding-0.33/datatables.js"></script><link href="deepdive_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="deepdive_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="deepdive_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="deepdive_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="deepdive_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="deepdive_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="deepdive_files/selectize-0.12.0/selectize.min.js"></script><link href="deepdive_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="deepdive_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Deep Dive into xportr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/xportr/blob/main/vignettes/deepdive.Rmd" class="external-link"><code>vignettes/deepdive.Rmd</code></a></small>
      <div class="d-none name"><code>deepdive.Rmd</code></div>
    </div>

    
    
<style type="text/css">
/* Used to control DT outputs */
.text-left {
  text-align: left;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will explore in detail all the possibilities of the
<a href="https://atorus-research.github.io/xportr/">xportr</a> package for applying information from a metadata
object to an R created dataset using the core <a href="https://atorus-research.github.io/xportr/">xportr</a>
functions.</p>
<p>We will also explore the following:</p>
<ul>
<li>What goes in a Submission to a Health Authority, and what role does
<a href="https://atorus-research.github.io/xportr/">xportr</a> play in that Submission?</li>
<li>What is <a href="https://atorus-research.github.io/xportr/">xportr</a> validating behind the scenes?</li>
<li>Breakdown of <a href="https://atorus-research.github.io/xportr/">xportr</a> and a ADaM dataset specification
file.</li>
<li>Using <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> and <code><a href="../reference/metadata.html">xportr_metadata()</a></code> to
enhance your <a href="https://atorus-research.github.io/xportr/">xportr</a> experience.</li>
<li>Understanding the warning and error messages for each
<a href="https://atorus-research.github.io/xportr/">xportr</a> function.</li>
<li>A brief discussion on future work.</li>
</ul>
<p><strong>NOTE:</strong> We use the phrase <em>metadata object</em>
throughout this package. A <em>metadata object</em> can either be a
specification file read into R as a dataframe or a
<a href="https://atorus-research.github.io/metacore/" class="external-link">metacore</a> object. The <em>metadata object</em> created via
the <a href="https://atorus-research.github.io/metacore/" class="external-link">metacore</a> package has additional features not covered
here, but at its core is using a specification file. However,
<a href="https://atorus-research.github.io/xportr/">xportr</a> will work with either a dataframe or a
<a href="https://atorus-research.github.io/metacore/" class="external-link">metacore</a> object.</p>
</div>
<div class="section level2">
<h2 id="what-goes-in-a-submission-to-a-health-authority">What goes in a Submission to a Health Authority?<a class="anchor" aria-label="anchor" href="#what-goes-in-a-submission-to-a-health-authority"></a>
</h2>
<p>Quite a bit! We will focus on the data deliverables and supporting
documentation needed for a successful submission to a Health Authority
and how <a href="https://atorus-research.github.io/xportr/">xportr</a> can play a key role. We will briefly look
at three parts:</p>
<ol style="list-style-type: decimal">
<li>Study Data Standardization Plan</li>
<li>SDTM Data Package</li>
<li>ADaM Data Package</li>
</ol>
<div class="section level3">
<h3 id="study-data-standardization-plan">Study Data Standardization Plan<a class="anchor" aria-label="anchor" href="#study-data-standardization-plan"></a>
</h3>
<p>The Study Data Standardization Plan (SDSP) establishes and documents
a plan for describing the data standardization approach for clinical and
nonclinical studies within a development program. The SDSP also assists
the FDA in identifying potential data standardization issues early in
the development program. We hope the brevity of this section does not
belie the huge importance of this document. Please see <a href="https://advance.hub.phuse.global/wiki/spaces/WEL/pages/26807922/Study+Data+Standardisation+Plan+SDSP+Package" class="external-link">Study
Data Standardisation Plan (SDSP) Package</a> maintained by the <a href="https://advance.hub.phuse.global/wiki/spaces/WEL/overview?homepageId=26804226" class="external-link">PHUSE
working group</a>. However, we want to focus more on the actual data and
how <a href="https://atorus-research.github.io/xportr/">xportr</a> can play a role in the submission.</p>
</div>
<div class="section level3">
<h3 id="sdtm-and-adam-data-packages">SDTM and ADaM Data Packages<a class="anchor" aria-label="anchor" href="#sdtm-and-adam-data-packages"></a>
</h3>
<p><strong>SDTM:</strong> The primary pieces of the SDTM package are the
SDTM annotated case report forms (acrf.pdf), the data definitions
document (define.xml), the Study Data Reviewer’s Guide (sdrg.pdf) and
the datasets in xpt Version 5 format. The Version 5 xpt file is the
<strong>required</strong> submission format for all datasets going to
the Health Authorities.</p>
<p><strong>ADaM:</strong> The key components of the ADaM package are
very similar to SDTM package with a few additions: define.xml, Analysis
Study Data Reviewer’s Guide (adrg.pdf), Analysis Results Metadata
(analysis-results-metadata.pdf) and datasets as Version 5 xpt
format.</p>
<p>As both Data Packages need compliant <code>xpt</code> files, we feel
that <a href="https://atorus-research.github.io/xportr/">xportr</a> can play a pivotal role here. The core
functions in <a href="https://atorus-research.github.io/xportr/">xportr</a> can be used to apply information from
the <em>metadata object</em> to the datasets giving users feedback on
the quality of the metadata and data. <code><a href="../reference/xportr_write.html">xportr_write()</a></code> can
then be used to write out the final dataset as an <code>xpt</code> file,
which can be submitted to a Health Authority.</p>
</div>
<div class="section level3">
<h3 id="what-is-xportr-validating-in-these-data-packages">What is <code>{xportr}</code> validating in these Data
Packages?<a class="anchor" aria-label="anchor" href="#what-is-xportr-validating-in-these-data-packages"></a>
</h3>
<p>The <code>xpt</code> Version 5 files form the backbone of any
successful Submission and are govern by quite a lot of rules and
suggested guidelines. As you are preparing your data packages for
submission the suite of core <a href="https://atorus-research.github.io/xportr/">xportr</a> functions, plus
<code><a href="../reference/xportr_write.html">xportr_write()</a></code>, helps to check that your datasets are
submission compliant. The package checks many of the latest rules laid
out in the <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/study-data-technical-conformance-guide-technical-specifications-document" class="external-link">Study
Data Technical Conformance Guide</a>, but please note that it is not yet
an exhaustive list of checks. We envision that users are also submitting
their <code>xpts</code> and metadata to additional validation
software.</p>
<p>Each of the core <a href="https://atorus-research.github.io/xportr/">xportr</a> functions for applying labels,
types, formats, order and lengths provides feedback to users on
submission compliance. However, a final check is implemented when
<code><a href="../reference/xportr_write.html">xportr_write()</a></code> is called to create the <code>xpt</code>.
<code><a href="../reference/xportr_write.html">xportr_write()</a></code> calls <a href="https://github.com/atorus-research/xportr/blob/231e959b84aa0f1e71113c85332de33a827e650a/R/utils-xportr.R#L174" class="external-link"><code>xpt_validate()</code></a>,
which is a behind the scenes/non-exported function that does a final
check for compliance. At the time of <code>{xportr} v0.3.0</code> we are
checking the following when a user writes out an <code>xpt</code>
file.:</p>
<p><img src="../reference/figures/xpt_validate.png" alt="validate" style="width: calc(100% - 2px); padding: 0; margin: 0;"></p>
</div>
</div>
<div class="section level2">
<h2 id="xportr-in-action">{xportr} in action<a class="anchor" aria-label="anchor" href="#xportr-in-action"></a>
</h2>
<p>In this section, we are going to explore the 5 core
<a href="https://atorus-research.github.io/xportr/">xportr</a> functions using:</p>
<ul>
<li>
<code>data("adsl_xportr", package = "xportr")</code> - An ADSL ADaM
dataset from the Pilot 3 Submission to the FDA</li>
<li>
<code>data("var_spec", package = "xportr")</code> - The ADSL ADaM
Specification File from the Pilot 3 Submission to the FDA</li>
</ul>
<p>We will focus on warning and error messaging with contrived examples
from these functions by manipulating either the datasets or the
specification files.</p>
<p><strong>NOTE:</strong> We have made the ADSL and Spec available in
this package. Users can find additional datasets and specification files
on our <a href="https://github.com/atorus-research/xportr" class="external-link">repo</a> in
the <code>example_data_specs</code> folder. This is to keep the package
to a minimum size.</p>
<div class="section level3">
<h3 id="using-options-and-xportr_metadata-to-enhance-your-experience-">Using <code>options()</code> and <code>xportr_metadata()</code> to
enhance your experience.<a class="anchor" aria-label="anchor" href="#using-options-and-xportr_metadata-to-enhance-your-experience-"></a>
</h3>
<p>Before we dive into the functions, we want to point out some quality
of life utilities to make your <code>xpt</code> generation life a little
bit easier.</p>
<ul>
<li><code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code></li>
<li><code><a href="../reference/xportr_options.html">xportr_options()</a></code></li>
<li><code><a href="../reference/metadata.html">xportr_metadata()</a></code></li>
</ul>
<p><strong>NOTE:</strong> As long as you have a well-defined
<em>metadata object</em> you do NOT need to use <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>
or <code><a href="../reference/metadata.html">xportr_metadata()</a></code>, but we find these handy to use and
think they deserve a quick mention!</p>
</div>
<div class="section level3">
<h3 id="youve-got-options-or-xportr_options">You’ve got <code>options()</code> or
<code>xportr_options()</code><a class="anchor" aria-label="anchor" href="#youve-got-options-or-xportr_options"></a>
</h3>
<p><a href="https://atorus-research.github.io/xportr/">xportr</a> is built with certain assumptions around
specification column names and information in those columns. We have
found that each company specification file can differ slightly from our
assumptions. For example, one company might call a column
<code>Variables</code>, another <code>Variable</code> and another
<code>variables</code>. Rather than trying to regex ourselves out of
this situation, we have introduced <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>.
<code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> allows users to control those assumptions inside
<a href="https://atorus-research.github.io/xportr/">xportr</a> functions based on their needs.</p>
<p>Additionally, we have a helper function <code><a href="../reference/xportr_options.html">xportr_options()</a></code>
which works just like the <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> but, it can also be
used to get the current state of the xportr options.</p>
<p>Let’s take a look at our example specification file names available
in this package. We can see that all the columns start with an upper
case letter and have spaces in several of them. We could convert all the
column names to lower case and deal with the spacing using some
<a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> functions or base R, or we could just use
<code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>!</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(xportr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"adsl_xportr"</span>, <span class="st">"var_spec"</span>, <span class="st">"dataset_spec"</span>, <span class="at">package =</span> <span class="st">"xportr"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">colnames</span>(var_spec)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>   [<span class="dv">1</span>] <span class="st">"Order"</span>              <span class="st">"Dataset"</span>            <span class="st">"Variable"</span>          </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>   [<span class="dv">4</span>] <span class="st">"Label"</span>              <span class="st">"Data Type"</span>          <span class="st">"Length"</span>            </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>   [<span class="dv">7</span>] <span class="st">"Significant Digits"</span> <span class="st">"Format"</span>             <span class="st">"Mandatory"</span>         </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  [<span class="dv">10</span>] <span class="st">"Assigned Value"</span>     <span class="st">"Codelist"</span>           <span class="st">"Common"</span>            </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  [<span class="dv">13</span>] <span class="st">"Origin"</span>             <span class="st">"Pages"</span>              <span class="st">"Method"</span>            </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  [<span class="dv">16</span>] <span class="st">"Predecessor"</span>        <span class="st">"Role"</span>               <span class="st">"Comment"</span>           </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  [<span class="dv">19</span>] <span class="st">"Developer Notes"</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>ADSL <span class="ot">&lt;-</span> adsl_xportr</span></code></pre></div>
<p>By using <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> or <code><a href="../reference/xportr_options.html">xportr_options()</a></code> at
the beginning of our script we can tell <a href="https://atorus-research.github.io/xportr/">xportr</a> what the
valid names are (see chunk below). Please note that before we set the
options the package assumed every thing was in lowercase and there were
no spaces in the names. After running <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> or
<code><a href="../reference/xportr_options.html">xportr_options()</a></code>, <a href="https://atorus-research.github.io/xportr/">xportr</a> sees the column
<code>Variable</code> as the valid name rather than
<code>variable</code>. You can inspect <code>xportr_options</code>
function docs to look at additional options.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/xportr_options.html">xportr_options</a></span><span class="op">(</span></span>
<span>  xportr.variable_name <span class="op">=</span> <span class="st">"Variable"</span>,</span>
<span>  xportr.label <span class="op">=</span> <span class="st">"Label"</span>,</span>
<span>  xportr.type_name <span class="op">=</span> <span class="st">"Data Type"</span>,</span>
<span>  xportr.format <span class="op">=</span> <span class="st">"Format"</span>,</span>
<span>  xportr.length <span class="op">=</span> <span class="st">"Length"</span>,</span>
<span>  xportr.order_name <span class="op">=</span> <span class="st">"Order"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or alternatively</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  xportr.variable_name <span class="op">=</span> <span class="st">"Variable"</span>,</span>
<span>  xportr.label <span class="op">=</span> <span class="st">"Label"</span>,</span>
<span>  xportr.type_name <span class="op">=</span> <span class="st">"Data Type"</span>,</span>
<span>  xportr.format <span class="op">=</span> <span class="st">"Format"</span>,</span>
<span>  xportr.length <span class="op">=</span> <span class="st">"Length"</span>,</span>
<span>  xportr.order_name <span class="op">=</span> <span class="st">"Order"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="are-we-being-too-verbose">Are we being too verbose?<a class="anchor" aria-label="anchor" href="#are-we-being-too-verbose"></a>
</h3>
<p>One final note on the options. 4 of the core <a href="https://atorus-research.github.io/xportr/">xportr</a>
functions have the ability to set messaging as
<code>"none", "message", "warn", "stop"</code>. Setting each of these in
all your calls can be a bit repetitive. You can use
<code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> or <code><a href="../reference/xportr_options.html">xportr_options()</a></code> to set these at
a higher level and avoid this repetition.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default verbose is set to `none`</span></span>
<span><span class="fu"><a href="../reference/xportr_options.html">xportr_options</a></span><span class="op">(</span></span>
<span>  xportr.format_verbose <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  xportr.label_verbose <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  xportr.length_verbose <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  xportr.type_verbose <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/xportr_options.html">xportr_options</a></span><span class="op">(</span></span>
<span>  xportr.format_verbose <span class="op">=</span> <span class="st">"none"</span>, <span class="co"># Disables any messaging, keeping the console output clean</span></span>
<span>  xportr.label_verbose <span class="op">=</span> <span class="st">"message"</span>, <span class="co"># Sends a standard message to the console</span></span>
<span>  xportr.length_verbose <span class="op">=</span> <span class="st">"warn"</span>, <span class="co"># Sends a warning message to the console</span></span>
<span>  xportr.type_verbose <span class="op">=</span> <span class="st">"stop"</span> <span class="co"># Stops execution and sends an error message to the console</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="going-meta">Going meta<a class="anchor" aria-label="anchor" href="#going-meta"></a>
</h3>
<p>Each of the core <a href="https://atorus-research.github.io/xportr/">xportr</a> functions requires several
inputs: A valid dataframe, a metadata object and a domain name, along
with optional messaging. For example, here is a simple call using all of
the functions. As you can see, a lot of information is repeated in each
call.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_type.html">xportr_type</a></span><span class="op">(</span><span class="va">var_spec</span>, <span class="st">"ADSL"</span>, <span class="st">"message"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_length.html">xportr_length</a></span><span class="op">(</span><span class="va">var_spec</span>, <span class="st">"ADSL"</span>, verbose <span class="op">=</span> <span class="st">"message"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_label.html">xportr_label</a></span><span class="op">(</span><span class="va">var_spec</span>, <span class="st">"ADSL"</span>, <span class="st">"message"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_order.html">xportr_order</a></span><span class="op">(</span><span class="va">var_spec</span>, <span class="st">"ADSL"</span>, <span class="st">"message"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_format.html">xportr_format</a></span><span class="op">(</span><span class="va">var_spec</span>, <span class="st">"ADSL"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_df_label.html">xportr_df_label</a></span><span class="op">(</span><span class="va">dataset_spec</span>, <span class="st">"ADSL"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_write.html">xportr_write</a></span><span class="op">(</span><span class="st">"adsl.xpt"</span><span class="op">)</span></span></code></pre></div>
<p>To help reduce these repetitive calls, we have created
<code><a href="../reference/metadata.html">xportr_metadata()</a></code>. A user can just <strong>set</strong> the
<em>metadata object</em> and the Domain name in the first call, and this
will be passed on to the other functions. Much cleaner!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/metadata.html">xportr_metadata</a></span><span class="op">(</span><span class="va">var_spec</span>, <span class="st">"ADSL"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_type.html">xportr_type</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_length.html">xportr_length</a></span><span class="op">(</span>length_source <span class="op">=</span> <span class="st">"metadata"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_label.html">xportr_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_order.html">xportr_order</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_format.html">xportr_format</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_df_label.html">xportr_df_label</a></span><span class="op">(</span><span class="va">dataset_spec</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_write.html">xportr_write</a></span><span class="op">(</span><span class="st">"adsl.xpt"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="warnings-and-errors">Warnings and Errors<a class="anchor" aria-label="anchor" href="#warnings-and-errors"></a>
</h3>
<p>For the next six sections, we are going to explore the Warnings and
Errors messages generated by the <a href="https://atorus-research.github.io/xportr/">xportr</a> core functions.
To better explore these, we will either manipulate the ADaM dataset or
specification file to help showcase the ability of the
<a href="https://atorus-research.github.io/xportr/">xportr</a> functions to detect issues.</p>
<p><strong>NOTE:</strong> We have made the ADSL,
<code>xportr::adsl</code>, and Specification File,
<code><a href="../reference/var_spec.html">xportr::var_spec</a></code>, available in this package. Users can find
additional datasets and specification files on our <a href="https://github.com/atorus-research/xportr" class="external-link">repo</a> in the
<code>example_data_specs</code> folder.</p>
<div class="section level4">
<h4 id="setting-up-our-metadata-object">Setting up our metadata object<a class="anchor" aria-label="anchor" href="#setting-up-our-metadata-object"></a>
</h4>
<p>First, let’s read in the specification file and call it
<code>var_spec</code>. Note that we are not using <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>
here. We will do some slight manipulation to the column names by doing
all lower case, and changing <code>Data Type</code> to <code>type</code>
and making the Order column numeric. You can also use
<code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> for this step as well. The <code>var_spec</code>
object has five dataset specification files stacked on top of each
other. We will make use of the <code>ADSL</code> subset of
<code>var_spec</code>. You can make use of the Search field above the
dataset column to subset the specification file for <code>ADSL</code>
Similarly, we can read the Dataset spec file and call it
<code>dataset_spec</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_spec</span> <span class="op">&lt;-</span> <span class="va">var_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Data Type"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="va">tolower</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataset_spec</span> <span class="op">&lt;-</span> <span class="va">dataset_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Description"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="va">tolower</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADADAS","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADAE","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADLBC","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADSL","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE","ADTTE"],["STUDYID","SITEID","SITEGR1","USUBJID","TRTSDT","TRTEDT","TRTP","TRTPN","AGE","AGEGR1","AGEGR1N","RACE","RACEN","SEX","ITTFL","EFFFL","COMP24FL","AVISIT","AVISITN","VISIT","VISITNUM","ADY","ADT","PARAM","PARAMCD","PARAMN","AVAL","BASE","CHG","PCHG","ABLFL","ANL01FL","DTYPE","AWRANGE","AWTARGET","AWTDIFF","AWLO","AWHI","AWU","QSSEQ","STUDYID","SITEID","USUBJID","TRTA","TRTAN","AGE","AGEGR1","AGEGR1N","RACE","RACEN","SEX","SAFFL","TRTSDT","TRTEDT","ASTDT","ASTDTF","ASTDY","AENDT","AENDY","ADURN","ADURU","AETERM","AELLT","AELLTCD","AEDECOD","AEPTCD","AEHLT","AEHLTCD","AEHLGT","AEHLGTCD","AEBODSYS","AESOC","AESOCCD","AESEV","AESER","AESCAN","AESCONG","AESDISAB","AESDTH","AESHOSP","AESLIFE","AESOD","AEREL","AEACN","AEOUT","AESEQ","TRTEMFL","AOCCFL","AOCCSFL","AOCCPFL","AOCC02FL","AOCC03FL","AOCC04FL","CQ01NAM","AOCC01FL","STUDYID","SUBJID","USUBJID","TRTP","TRTPN","TRTA","TRTAN","TRTSDT","TRTEDT","AGE","AGEGR1","AGEGR1N","RACE","RACEN","SEX","COMP24FL","DSRAEFL","SAFFL","AVISIT","AVISITN","ADY","ADT","VISIT","VISITNUM","PARAM","PARAMCD","PARAMN","PARCAT1","AVAL","BASE","CHG","A1LO","A1HI","R2A1LO","R2A1HI","BR2A1LO","BR2A1HI","ANL01FL","ALBTRVAL","ANRIND","BNRIND","ABLFL","AENTMTFL","LBSEQ","LBNRIND","LBSTRESN","STUDYID","USUBJID","SUBJID","SITEID","SITEGR1","ARM","TRT01P","TRT01PN","TRT01A","TRT01AN","TRTSDT","TRTEDT","TRTDURD","AVGDD","CUMDOSE","AGE","AGEGR1","AGEGR1N","AGEU","RACE","RACEN","SEX","ETHNIC","SAFFL","ITTFL","EFFFL","COMP8FL","COMP16FL","COMP24FL","DISCONFL","DSRAEFL","DTHFL","BMIBL","BMIBLGR1","HEIGHTBL","WEIGHTBL","EDUCLVL","DISONSDT","DURDIS","DURDSGR1","VISIT1DT","RFSTDTC","RFENDTC","VISNUMEN","RFENDT","DCDECOD","EOSSTT","DCSREAS","MMSETOT","STUDYID","SITEID","USUBJID","AGE","AGEGR1","AGEGR1N","RACE","RACEN","SEX","TRTSDT","TRTEDT","TRTDUR","TRTP","TRTA","TRTAN","PARAM","PARAMCD","AVAL","STARTDT","ADT","CNSR","EVNTDESC","SRCDOM","SRCVAR","SRCSEQ","SAFFL"],["Study Identifier","Study Site Identifier","Pooled Site Group 1","Unique Subject Identifier","Date of First Exposure to Treatment","Date of Last Exposure to Treatment","Planned Treatment","Planned Treatment (N)","Age","Pooled Age Group 1","Pooled Age Group 1 (N)","Race","Race (N)","Sex","Intent-To-Treat Population Flag","Efficacy Population Flag","Completers of Week 24 Population Flag","Analysis Visit","Analysis Visit (N)","Visit Name","Visit Number","Analysis Relative Day","Analysis Date","Parameter","Parameter Code","Parameter (N)","Analysis Value","Baseline Value","Change from Baseline","Percent Change from Baseline","Baseline Record Flag","Analysis Flag 01","Derivation Type","Analysis Window Valid Relative Range","Analysis Window Target","Analysis Window Diff from Target","Analysis Window Beginning Timepoint","Analysis Window Ending Timepoint","Analysis Window Unit","Sequence Number","Study Identifier","Study Site Identifier","Unique Subject Identifier","Actual Treatment","Actual Treatment (N)","Age","Pooled Age Group 1","Pooled Age Group 1 (N)","Race","Race (N)","Sex","Safety Population Flag","Date of First Exposure to Treatment","Date of Last Exposure to Treatment","Analysis Start Date","Analysis Start Date Imputation Flag","Analysis Start Relative Day","Analysis End Date","Analysis End Relative Day","Analysis Duration (N)","Analysis Duration Units","Reported Term for the Adverse Event","Lowest Level Term","Lowest Level Term Code","Dictionary-Derived Term","Preferred Term Code","High Level Term","High Level Term Code","High Level Group Term","High Level Group Term Code","Body System or Organ Class","Primary System Organ Class","Primary System Organ Class Code","Severity/Intensity","Serious Event","Involves Cancer","Congenital Anomaly or Birth Defect","Persist or Signif Disability/Incapacity","Results in Death","Requires or Prolongs Hospitalization","Is Life Threatening","Occurred with Overdose","Causality","Action Taken with Study Treatment","Outcome of Adverse Event","Sequence Number","Treatment Emergent Analysis Flag","1st Occurrence within Subject Flag","1st Occurrence of SOC Flag","1st Occurrence of Preferred Term Flag","1st Occurrence 02 Flag for Serious","1st Occurrence 03 Flag for Serious SOC","1st Occurrence 04 Flag for Serious PT","Customized Query 01 Name","1st Occurrence 01 Flag for CQ01","Study Identifier","Subject Identifier for the Study","Unique Subject Identifier","Planned Treatment","Planned Treatment (N)","Actual Treatment","Actual Treatment (N)","Date of First Exposure to Treatment","Date of Last Exposure to Treatment","Age","Pooled Age Group 1","Pooled Age Group 1 (N)","Race","Race (N)","Sex","Completers of Week 24 Population Flag","Discontinued due to AE?","Safety Population Flag","Analysis Visit","Analysis Visit (N)","Analysis Relative Day","Analysis Date","Visit Name","Visit Number","Parameter","Parameter Code","Parameter (N)","Parameter Category 1","Analysis Value","Baseline Value","Change from Baseline","Analysis Range 1 Lower Limit","Analysis Range 1 Upper Limit","Ratio to Analysis Range 1 Lower Limit","Ratio to Analysis Range 1 Upper Limit","Base Ratio to Analysis Range 1 Lower Lim","Base Ratio to Analysis Range 1 Upper Lim","Analysis Flag 01","Amount Threshold Range","Analysis Reference Range Indicator","Baseline Reference Range Indicator","Baseline Record Flag","Last value in treatment visit","Sequence Number","Reference Range Indicator","Numeric Result/Finding in Standard Units","Study Identifier","Unique Subject Identifier","Subject Identifier for the Study","Study Site Identifier","Pooled Site Group 1","Description of Planned Arm","Planned Treatment for Period 01","Planned Treatment for Period 01 (N)","Actual Treatment for Period 01","Actual Treatment for Period 01 (N)","Date of First Exposure to Treatment","Date of Last Exposure to Treatment","Total Treatment Duration (Days)","Avg Daily Dose (as planned)","Cumulative Dose (as planned)","Age","Pooled Age Group 1","Pooled Age Group 1 (N)","Age Units","Race","Race (N)","Sex","Ethnicity","Safety Population Flag","Intent-To-Treat Population Flag","Efficacy Population Flag","Completers of Week 8 Population Flag","Completers of Week 16 Population Flag","Completers of Week 24 Population Flag","Did the Subject Discontinue the Study?","Discontinued due to AE?","Subject Died?","Baseline BMI (kg/m^2)","Pooled Baseline BMI Group 1","Baseline Height (cm)","Baseline Weight (kg)","Years of Education","Date of Onset of Disease","Duration of Disease (Months)","Pooled Disease Duration Group 1","Date of Visit 1","Subject Reference Start Date/Time","Subject Reference End Date/Time","End of Trt Visit (Vis 12 or Early Term.)","Date of Discontinuation/Completion","Standardized Disposition Term","End of Study Status","Reason for Discontinuation from Study","MMSE Total","Study Identifier","Study Site Identifier","Unique Subject Identifier","Age","Pooled Age Group 1","Pooled Age Group 1 (N)","Race","Race (N)","Sex","Date of First Exposure to Treatment","Date of Last Exposure to Treatment","Duration of treatment (days)","Planned Treatment","Actual Treatment","Actual Treatment (N)","Parameter","Parameter Code","Analysis Value","Time-to-Event Origin Date for Subject","Analysis Date","Censor","Event or Censoring Description","Source Data","Source Variable","Source Sequence Number","Safety Population Flag"],["text","text","text","text","integer","integer","text","integer","integer","text","integer","text","integer","text","text","text","text","text","integer","text","float","integer","integer","text","text","integer","float","integer","integer","integer","text","text","text","text","integer","integer","integer","integer","text","integer","text","text","text","text","integer","integer","text","integer","text","integer","text","text","integer","integer","integer","text","integer","integer","integer","integer","text","text","text","integer","text","integer","text","integer","text","integer","text","text","integer","text","text","text","text","text","text","text","text","text","text","text","text","integer","text","text","text","text","text","text","text","text","text","text","text","text","text","integer","text","integer","integer","integer","integer","text","integer","text","integer","text","text","text","text","text","integer","integer","integer","text","float","text","text","integer","text","float","float","float","float","float","float","float","float","float","text","float","text","text","text","text","integer","text","float","text","text","text","text","text","text","text","integer","text","integer","integer","integer","integer","float","float","integer","text","integer","text","text","integer","text","text","text","text","text","text","text","text","text","text","text","float","text","float","float","integer","integer","float","text","integer","text","text","integer","integer","text","text","text","integer","text","text","text","integer","text","integer","text","integer","text","integer","integer","integer","text","text","integer","text","text","integer","integer","integer","integer","text","text","text","integer","text"],["12","3","3","11","8","8","20","8","8","5","8","32","8","1","1","1","1","16","8","19","8","8","8","100","8","8","16","8","8","8","1","1","7","9","8","8","8","8","4","8","12","3","11","20","8","8","5","8","32","8","1","1","8","8","8","1","8","8","8","8","3","46","46","8","46","8","8","8","9","8","67","67","8","8","1","1","1","1","1","1","1","1","8","1","26","8","1","1","1","1","1","1","1","19","1","12","4","11","20","8","20","8","8","8","8","5","8","32","8","1","1","1","1","16","8","8","8","19","8","100","8","8","5","8","8","8","8","8","8","8","8","8","1","8","1","1","1","1","8","8","8","12","11","4","3","3","20","20","8","20","8","8","8","8","8","8","8","5","8","5","32","8","1","22","1","1","1","1","1","1","1","1","1","8","6","8","8","8","8","8","4","8","20","20","8","8","27","12","18","8","12","3","11","8","5","8","32","8","1","8","8","8","20","20","8","100","8","8","8","8","8","25","4","6","8","1"],[null,null,null,null,"DATE9.","DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.","DATE9.","DATE9.",null,null,"DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.","DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.","DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.",null,null,"DATE9.",null,null,null,"DATE9.",null,null,null,null,null,null,null,null,null,null,null,null,null,"DATE9.","DATE9.",null,null,null,null,null,null,null,"DATE9.","DATE9.",null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>order<\/th>\n      <th>dataset<\/th>\n      <th>variable<\/th>\n      <th>label<\/th>\n      <th>type<\/th>\n      <th>length<\/th>\n      <th>format<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","columnDefs":[{"width":"10px","targets":[0,5,6,4,1,2]},{"className":"text-left","targets":3},{"name":"order","targets":0},{"name":"dataset","targets":1},{"name":"variable","targets":2},{"name":"label","targets":3},{"name":"type","targets":4},{"name":"length","targets":5},{"name":"format","targets":6}],"searching":false,"autoWidth":true,"order":[],"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[-1]; $(row).css({'font-weight':'500','color':'black','background-color':'white','line-height':'85%','text-align':'center','font-size':'.875em'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<div class="section level3">
<h3 id="xportr_type">
<code>xportr_type()</code><a class="anchor" aria-label="anchor" href="#xportr_type"></a>
</h3>
<p>We are going to explore the type column in the metadata object. A
submission to a Health Authority should only have character and numeric
types in the data. In the <code>ADSL</code> data we have several columns
that are in the Date type: <code>TRTSDT</code>, <code>TRTEDT</code>,
<code>SCRFDT</code>, <code>EOSDT</code>, <code>FRVDT</code>,
<code>RANDDT</code>, <code>DTHDT</code>, <code>LSTALVDT</code> - under
the hood these are actually numeric values and will be left as is. We
will change one variable type to a <a href="https://forcats.tidyverse.org/" class="external-link">factor variable</a>, which is a
common data structure in R, to give us some educational opportunities to
see <code><a href="../reference/xportr_type.html">xportr_type()</a></code> in action.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adsl_fct</span> <span class="op">&lt;-</span> <span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">STUDYID</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>  Rows: 306
  Columns: 9
  $ STUDYID  &lt;fct&gt; CDISCPILOT01, CDISCPILOT01, CDISCPILOT01, CDISCPILOT01, CDISC…
  $ TRTSDT   &lt;date&gt; 2014-01-02, 2012-08-05, 2013-07-19, 2014-03-18, 2014-07-01, …
  $ TRTEDT   &lt;date&gt; 2014-07-02, 2012-09-01, 2014-01-14, 2014-03-31, 2014-12-30, …
  $ SCRFDT   &lt;date&gt; NA, NA, NA, NA, NA, NA, 2013-12-20, NA, NA, NA, NA, NA, NA, …
  $ EOSDT    &lt;date&gt; 2014-07-02, 2012-09-02, 2014-01-14, 2014-04-14, 2014-12-30, …
  $ FRVDT    &lt;date&gt; NA, 2013-02-18, NA, 2014-09-15, NA, 2013-07-28, NA, NA, 2013…
  $ RANDDT   &lt;date&gt; 2014-01-02, 2012-08-05, 2013-07-19, 2014-03-18, 2014-07-01, …
  $ DTHDT    &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
  $ LSTALVDT &lt;date&gt; 2014-07-02, 2012-09-02, 2014-01-14, 2014-04-14, 2014-12-30, …</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>adsl_type <span class="ot">&lt;-</span> <span class="fu">xportr_type</span>(<span class="at">.df =</span> adsl_fct, <span class="at">metadata =</span> var_spec, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">verbose =</span> <span class="st">"warn"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  ── Variable type mismatches found. ──</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  ✔ <span class="dv">1</span> variable coerced</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  Warning<span class="sc">:</span> Variable <span class="fu">type</span>(s) <span class="cf">in</span> dataframe don<span class="st">'t match metadata: `STUDYID`</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="st">  - `STUDYID` was coerced to &lt;character&gt;. (type in data: factor, type in metadata: text)</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="st">  i Types in metadata considered as character (xportr.character_metadata_types option): '</span>character<span class="st">', '</span>char<span class="st">', '</span>text<span class="st">', '</span>date<span class="st">', '</span>posixct<span class="st">', '</span>posixt<span class="st">', '</span>datetime<span class="st">', '</span>time<span class="st">', '</span>partialdate<span class="st">', '</span>partialtime<span class="st">', '</span>partialdatetime<span class="st">', '</span>incompletedatetime<span class="st">', '</span>durationdatetime<span class="st">', and '</span>intervaldatetime<span class="st">'</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="st">  i Types in metadata considered as numeric (xportr.numeric_metadata_types option): '</span>integer<span class="st">', '</span>numeric<span class="st">', '</span>num<span class="st">', and '</span>float<span class="st">'</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="st">  i Types in data considered as character (xportr.character_types option): '</span>character<span class="st">'</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="st">  i Types in data considered as numeric (xportr.numeric_types option): '</span>integer<span class="st">', '</span>float<span class="st">', '</span>numeric<span class="st">', '</span>posixct<span class="st">', '</span>posixt<span class="st">', '</span>time<span class="st">', '</span>date<span class="st">', and '</span>hms<span class="st">'</span></span></code></pre></div>
<p>Success! As we can see below, <code><a href="../reference/xportr_type.html">xportr_type()</a></code> applied the
types from the metadata object to the <code>STUDYID</code> variables
converting to the proper type. The functions in <a href="https://atorus-research.github.io/xportr/">xportr</a>
also display this coercion to the user in the console, which is seen
above.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">glimpse</span>(adsl_type_glimpse)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  Rows<span class="sc">:</span> <span class="dv">306</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  Columns<span class="sc">:</span> <span class="dv">9</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="sc">$</span> STUDYID  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"CDISCPILOT01"</span>, <span class="st">"CDISCPILOT01"</span>, <span class="st">"CDISCPILOT01"</span>, <span class="st">"CDISCPILOT01…</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="st">  $ TRTSDT   &lt;date&gt; 2014-01-02, 2012-08-05, 2013-07-19, 2014-03-18, 2014-07-01, …</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="st">  $ TRTEDT   &lt;date&gt; 2014-07-02, 2012-09-01, 2014-01-14, 2014-03-31, 2014-12-30, …</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="st">  $ SCRFDT   &lt;date&gt; NA, NA, NA, NA, NA, NA, 2013-12-20, NA, NA, NA, NA, NA, NA, …</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="st">  $ EOSDT    &lt;date&gt; 2014-07-02, 2012-09-02, 2014-01-14, 2014-04-14, 2014-12-30, …</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="st">  $ FRVDT    &lt;date&gt; NA, 2013-02-18, NA, 2014-09-15, NA, 2013-07-28, NA, NA, 2013…</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="st">  $ RANDDT   &lt;date&gt; 2014-01-02, 2012-08-05, 2013-07-19, 2014-03-18, 2014-07-01, …</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="st">  $ DTHDT    &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="st">  $ LSTALVDT &lt;date&gt; 2014-07-02, 2012-09-02, 2014-01-14, 2014-04-14, 2014-12-30, …</span></span></code></pre></div>
<p>Note that <code>xportr_type(verbose = "warn")</code> was set so the
function has provided feedback, which would show up in the console, on
which variables were converted as a warning message. However, you can
set <code>verbose = "stop"</code> so that the types are not applied if
the data does not match what is in the specification file. Using
<code>verbose = "stop"</code> will instantly stop the processing of this
function and not create the object. A user will need to alter the
variables in their R script before using <code><a href="../reference/xportr_type.html">xportr_type()</a></code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>adsl_type <span class="ot">&lt;-</span> <span class="fu">xportr_type</span>(<span class="at">.df =</span> adsl_fct, <span class="at">metadata =</span> var_spec, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">verbose =</span> <span class="st">"stop"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  ── Variable type mismatches found. ──</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  ✔ <span class="dv">1</span> variable coerced</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="st">`</span><span class="at">xportr_logger()</span><span class="st">`</span> at xportr<span class="sc">/</span>R<span class="sc">/</span>messages.R<span class="sc">:</span><span class="dv">126</span><span class="sc">:</span><span class="dv">5</span><span class="sc">:</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="sc">!</span> Variable <span class="fu">type</span>(s) <span class="cf">in</span> dataframe don<span class="st">'t match metadata: `STUDYID`</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="st">  - `STUDYID` was coerced to &lt;character&gt;. (type in data: factor, type in metadata: text)</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="st">  i Types in metadata considered as character (xportr.character_metadata_types option): '</span>character<span class="st">', '</span>char<span class="st">', '</span>text<span class="st">', '</span>date<span class="st">', '</span>posixct<span class="st">', '</span>posixt<span class="st">', '</span>datetime<span class="st">', '</span>time<span class="st">', '</span>partialdate<span class="st">', '</span>partialtime<span class="st">', '</span>partialdatetime<span class="st">', '</span>incompletedatetime<span class="st">', '</span>durationdatetime<span class="st">', and '</span>intervaldatetime<span class="st">'</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="st">  i Types in metadata considered as numeric (xportr.numeric_metadata_types option): '</span>integer<span class="st">', '</span>numeric<span class="st">', '</span>num<span class="st">', and '</span>float<span class="st">'</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="st">  i Types in data considered as character (xportr.character_types option): '</span>character<span class="st">'</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="st">  i Types in data considered as numeric (xportr.numeric_types option): '</span>integer<span class="st">', '</span>float<span class="st">', '</span>numeric<span class="st">', '</span>posixct<span class="st">', '</span>posixt<span class="st">', '</span>time<span class="st">', '</span>date<span class="st">', and '</span>hms<span class="st">'</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="xportr_length">
<code>xportr_length()</code><a class="anchor" aria-label="anchor" href="#xportr_length"></a>
</h3>
<p>There are two sources of length (data-driven and spec-driven):</p>
<ul>
<li><p>Data-driven length: max length for character columns and 8 for
other data types</p></li>
<li><p>Spec-driven length: from the metadata</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Users can either specify the length in the metadata or leave it
blank for data-driven length.</li>
<li>When the length is missing in the metadata, the data-driven length
will be applied.</li>
</ol>
<p>Next we will use <code><a href="../reference/xportr_length.html">xportr_length()</a></code> to apply the length
column of the <em>metadata object</em> to the <code>ADSL</code> dataset.
Using the <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> function we have displayed all the
variables with their attributes. You can see that each variable has a
label, but there is no information on the lengths of the variable.</p>
<pre style="max-height: 300px;"><code>  tibble [306 × 51] (S3: tbl_df/tbl/data.frame)
   $ STUDYID : chr [1:306] "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" ...
    ..- attr(*, "label")= chr "Study Identifier"
   $ USUBJID : chr [1:306] "01-701-1015" "01-701-1023" "01-701-1028" "01-701-1033" ...
    ..- attr(*, "label")= chr "Unique Subject Identifier"
   $ SUBJID  : chr [1:306] "1015" "1023" "1028" "1033" ...
    ..- attr(*, "label")= chr "Subject Identifier for the Study"
   $ RFSTDTC : chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Subject Reference Start Date/Time"
   $ RFENDTC : chr [1:306] "2014-07-02" "2012-09-02" "2014-01-14" "2014-04-14" ...
    ..- attr(*, "label")= chr "Subject Reference End Date/Time"
   $ RFXSTDTC: chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Date/Time of First Study Treatment"
   $ RFXENDTC: chr [1:306] "2014-07-02" "2012-09-01" "2014-01-14" "2014-03-31" ...
    ..- attr(*, "label")= chr "Date/Time of Last Study Treatment"
   $ RFICDTC : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Date/Time of Informed Consent"
   $ RFPENDTC: chr [1:306] "2014-07-02T11:45" "2013-02-18" "2014-01-14T11:10" "2014-09-15" ...
    ..- attr(*, "label")= chr "Date/Time of End of Participation"
   $ DTHDTC  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Date/Time of Death"
   $ DTHFL   : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Subject Death Flag"
   $ SITEID  : chr [1:306] "701" "701" "701" "701" ...
    ..- attr(*, "label")= chr "Study Site Identifier"
   $ AGE     : num [1:306] 63 64 71 74 77 85 59 68 81 84 ...
    ..- attr(*, "label")= chr "Age"
   $ AGEU    : chr [1:306] "YEARS" "YEARS" "YEARS" "YEARS" ...
    ..- attr(*, "label")= chr "Age Units"
   $ SEX     : chr [1:306] "F" "M" "M" "M" ...
    ..- attr(*, "label")= chr "Sex"
   $ RACE    : chr [1:306] "WHITE" "WHITE" "WHITE" "WHITE" ...
    ..- attr(*, "label")= chr "Race"
   $ ETHNIC  : chr [1:306] "HISPANIC OR LATINO" "HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" ...
    ..- attr(*, "label")= chr "Ethnicity"
   $ ARMCD   : chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr "Planned Arm Code"
   $ ARM     : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
   $ ACTARMCD: chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr "Actual Arm Code"
   $ ACTARM  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Actual Arm"
   $ COUNTRY : chr [1:306] "USA" "USA" "USA" "USA" ...
    ..- attr(*, "label")= chr "Country"
   $ DMDTC   : chr [1:306] "2013-12-26" "2012-07-22" "2013-07-11" "2014-03-10" ...
    ..- attr(*, "label")= chr "Date/Time of Collection"
   $ DMDY    : num [1:306] -7 -14 -8 -8 -7 -21 NA -9 -13 -7 ...
    ..- attr(*, "label")= chr "Study Day of Collection"
   $ TRT01P  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
   $ TRT01A  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Actual Arm"
   $ TRTSDTM : POSIXct[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTSTMF : chr [1:306] "H" "H" "H" "H" ...
   $ TRTEDTM : POSIXct[1:306], format: "2014-07-02 23:59:59" "2012-09-01 23:59:59" ...
   $ TRTETMF : chr [1:306] "H" "H" "H" "H" ...
   $ TRTSDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTEDT  : Date[1:306], format: "2014-07-02" "2012-09-01" ...
   $ TRTDURD : num [1:306] 182 28 180 14 183 26 NA 190 10 55 ...
   $ SCRFDT  : Date[1:306], format: NA NA ...
   $ EOSDT   : Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ EOSSTT  : chr [1:306] "COMPLETED" "DISCONTINUED" "COMPLETED" "DISCONTINUED" ...
   $ FRVDT   : Date[1:306], format: NA "2013-02-18" ...
   $ RANDDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ DTHDT   : Date[1:306], format: NA NA ...
   $ DTHDTF  : chr [1:306] NA NA NA NA ...
   $ DTHADY  : num [1:306] NA NA NA NA NA NA NA NA NA NA ...
   $ LDDTHELD: num [1:306] NA NA NA NA NA NA NA NA NA NA ...
   $ LSTALVDT: Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ SAFFL   : chr [1:306] "Y" "Y" "Y" "Y" ...
   $ RACEGR1 : chr [1:306] "White" "White" "White" "White" ...
   $ AGEGR1  : chr [1:306] "18-64" "18-64" "&gt;64" "&gt;64" ...
   $ REGION1 : chr [1:306] "NA" "NA" "NA" "NA" ...
   $ LDDTHGR1: chr [1:306] NA NA NA NA ...
   $ DTH30FL : chr [1:306] NA NA NA NA ...
   $ DTHA30FL: chr [1:306] NA NA NA NA ...
   $ DTHB30FL: chr [1:306] NA NA NA NA ...
   - attr(*, "label")= chr "Demographics"</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>adsl_length <span class="ot">&lt;-</span> <span class="fu">xportr_length</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="at">.df =</span> ADSL,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">metadata =</span> var_spec,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">domain =</span> <span class="st">"ADSL"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="st">"warn"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="at">length_source =</span> <span class="st">"metadata"</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  ── Variable lengths missing from metadata. ──</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  ✔ <span class="dv">30</span> lengths resolved <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  Warning<span class="sc">:</span> <span class="fu">Variable</span>(s) present <span class="cf">in</span> dataframe but doesn<span class="st">'t exist in</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="st">  `metadata`.Problem with `RFXSTDTC`, `RFXENDTC`, `RFICDTC`, `RFPENDTC`,</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="st">  `DTHDTC`, `ARMCD`, `ACTARMCD`, `ACTARM`, `COUNTRY`, `DMDTC`, `DMDY`, `TRTSDTM`,</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="st">  `TRTSTMF`, `TRTEDTM`, `TRTETMF`, `SCRFDT`, `EOSDT`, `FRVDT`, `RANDDT`, `DTHDT`,</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="st">  `DTHDTF`, `DTHADY`, `LDDTHELD`, `LSTALVDT`, `RACEGR1`, `REGION1`, `LDDTHGR1`,</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="st">  `DTH30FL`, `DTHA30FL`, and `DTHB30FL`</span></span></code></pre></div>
<p>Using <code><a href="../reference/xportr_length.html">xportr_length()</a></code> with <code>verbose = "warn"</code>
we can apply the length column to all the columns in the dataset. The
function detects that two variables, <code>TRTDUR</code> and
<code>DCREASCD</code> are missing from the metadata file. Note that the
variables have slight misspellings in the dataset and metadata, which is
a great catch! However, lengths are still applied with TRTDUR being give
a length of 8 and DCREASCD a length of 200.</p>
<p>Using the <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> function, you can see below that
<code><a href="../reference/xportr_length.html">xportr_length()</a></code> successfully applied all the lengths of the
variable to the variables in the dataset.</p>
<pre style="max-height: 300px;"><code>  tibble [306 × 51] (S3: tbl_df/tbl/data.frame)
   $ STUDYID : chr [1:306] "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" ...
    ..- attr(*, "label")= chr "Study Identifier"
    ..- attr(*, "width")= num 12
   $ USUBJID : chr [1:306] "01-701-1015" "01-701-1023" "01-701-1028" "01-701-1033" ...
    ..- attr(*, "label")= chr "Unique Subject Identifier"
    ..- attr(*, "width")= num 11
   $ SUBJID  : chr [1:306] "1015" "1023" "1028" "1033" ...
    ..- attr(*, "label")= chr "Subject Identifier for the Study"
    ..- attr(*, "width")= num 4
   $ RFSTDTC : chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Subject Reference Start Date/Time"
    ..- attr(*, "width")= num 20
   $ RFENDTC : chr [1:306] "2014-07-02" "2012-09-02" "2014-01-14" "2014-04-14" ...
    ..- attr(*, "label")= chr "Subject Reference End Date/Time"
    ..- attr(*, "width")= num 20
   $ RFXSTDTC: chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Date/Time of First Study Treatment"
    ..- attr(*, "width")= num 10
   $ RFXENDTC: chr [1:306] "2014-07-02" "2012-09-01" "2014-01-14" "2014-03-31" ...
    ..- attr(*, "label")= chr "Date/Time of Last Study Treatment"
    ..- attr(*, "width")= num 10
   $ RFICDTC : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Date/Time of Informed Consent"
    ..- attr(*, "width")= num 0
   $ RFPENDTC: chr [1:306] "2014-07-02T11:45" "2013-02-18" "2014-01-14T11:10" "2014-09-15" ...
    ..- attr(*, "label")= chr "Date/Time of End of Participation"
    ..- attr(*, "width")= num 16
   $ DTHDTC  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Date/Time of Death"
    ..- attr(*, "width")= num 10
   $ DTHFL   : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Subject Death Flag"
    ..- attr(*, "width")= num 1
   $ SITEID  : chr [1:306] "701" "701" "701" "701" ...
    ..- attr(*, "label")= chr "Study Site Identifier"
    ..- attr(*, "width")= num 3
   $ AGE     : num [1:306] 63 64 71 74 77 85 59 68 81 84 ...
    ..- attr(*, "label")= chr "Age"
    ..- attr(*, "width")= num 8
   $ AGEU    : chr [1:306] "YEARS" "YEARS" "YEARS" "YEARS" ...
    ..- attr(*, "label")= chr "Age Units"
    ..- attr(*, "width")= num 5
   $ SEX     : chr [1:306] "F" "M" "M" "M" ...
    ..- attr(*, "label")= chr "Sex"
    ..- attr(*, "width")= num 1
   $ RACE    : chr [1:306] "WHITE" "WHITE" "WHITE" "WHITE" ...
    ..- attr(*, "label")= chr "Race"
    ..- attr(*, "width")= num 32
   $ ETHNIC  : chr [1:306] "HISPANIC OR LATINO" "HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" ...
    ..- attr(*, "label")= chr "Ethnicity"
    ..- attr(*, "width")= num 22
   $ ARMCD   : chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr "Planned Arm Code"
    ..- attr(*, "width")= num 8
   $ ARM     : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
    ..- attr(*, "width")= num 20
   $ ACTARMCD: chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr "Actual Arm Code"
    ..- attr(*, "width")= num 8
   $ ACTARM  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Actual Arm"
    ..- attr(*, "width")= num 20
   $ COUNTRY : chr [1:306] "USA" "USA" "USA" "USA" ...
    ..- attr(*, "label")= chr "Country"
    ..- attr(*, "width")= num 3
   $ DMDTC   : chr [1:306] "2013-12-26" "2012-07-22" "2013-07-11" "2014-03-10" ...
    ..- attr(*, "label")= chr "Date/Time of Collection"
    ..- attr(*, "width")= num 10
   $ DMDY    : num [1:306] -7 -14 -8 -8 -7 -21 NA -9 -13 -7 ...
    ..- attr(*, "label")= chr "Study Day of Collection"
    ..- attr(*, "width")= num 8
   $ TRT01P  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
    ..- attr(*, "width")= num 20
   $ TRT01A  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Actual Arm"
    ..- attr(*, "width")= num 20
   $ TRTSDTM : POSIXct[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTSTMF : chr [1:306] "H" "H" "H" "H" ...
    ..- attr(*, "width")= num 1
   $ TRTEDTM : POSIXct[1:306], format: "2014-07-02 23:59:59" "2012-09-01 23:59:59" ...
   $ TRTETMF : chr [1:306] "H" "H" "H" "H" ...
    ..- attr(*, "width")= num 1
   $ TRTSDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTEDT  : Date[1:306], format: "2014-07-02" "2012-09-01" ...
   $ TRTDURD : num [1:306] 182 28 180 14 183 26 NA 190 10 55 ...
    ..- attr(*, "width")= num 8
   $ SCRFDT  : Date[1:306], format: NA NA ...
   $ EOSDT   : Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ EOSSTT  : chr [1:306] "COMPLETED" "DISCONTINUED" "COMPLETED" "DISCONTINUED" ...
    ..- attr(*, "width")= num 12
   $ FRVDT   : Date[1:306], format: NA "2013-02-18" ...
   $ RANDDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ DTHDT   : Date[1:306], format: NA NA ...
   $ DTHDTF  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "width")= num 0
   $ DTHADY  : num [1:306] NA NA NA NA NA NA NA NA NA NA ...
    ..- attr(*, "width")= num 8
   $ LDDTHELD: num [1:306] NA NA NA NA NA NA NA NA NA NA ...
    ..- attr(*, "width")= num 8
   $ LSTALVDT: Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ SAFFL   : chr [1:306] "Y" "Y" "Y" "Y" ...
    ..- attr(*, "width")= num 1
   $ RACEGR1 : chr [1:306] "White" "White" "White" "White" ...
    ..- attr(*, "width")= num 9
   $ AGEGR1  : chr [1:306] "18-64" "18-64" "&gt;64" "&gt;64" ...
    ..- attr(*, "width")= num 5
   $ REGION1 : chr [1:306] "NA" "NA" "NA" "NA" ...
    ..- attr(*, "width")= num 2
   $ LDDTHGR1: chr [1:306] NA NA NA NA ...
    ..- attr(*, "width")= num 5
   $ DTH30FL : chr [1:306] NA NA NA NA ...
    ..- attr(*, "width")= num 1
   $ DTHA30FL: chr [1:306] NA NA NA NA ...
    ..- attr(*, "width")= num 0
   $ DTHB30FL: chr [1:306] NA NA NA NA ...
    ..- attr(*, "width")= num 1
   - attr(*, "label")= chr "Demographics"
   - attr(*, "_xportr.df_arg_")= chr "ADSL"</code></pre>
<p>Just like we did for <code><a href="../reference/xportr_type.html">xportr_type()</a></code>, setting
<code>verbose = "stop"</code> immediately stops R from processing the
lengths. Here the function detects the missing variables and will not
apply any lengths to the dataset until corrective action is applied.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>adsl_length <span class="ot">&lt;-</span> <span class="fu">xportr_length</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">.df =</span> ADSL,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">metadata =</span> var_spec,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">domain =</span> <span class="st">"ADSL"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="st">"stop"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">length_source =</span> <span class="st">"metadata"</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  ── Variable lengths missing from metadata. ──</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  </span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  ✔ <span class="dv">30</span> lengths resolved <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="st">`</span><span class="at">xportr_logger()</span><span class="st">`</span> at xportr<span class="sc">/</span>R<span class="sc">/</span>messages.R<span class="sc">:</span><span class="dv">147</span><span class="sc">:</span><span class="dv">5</span><span class="sc">:</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="sc">!</span> <span class="fu">Variable</span>(s) present <span class="cf">in</span> dataframe but doesn<span class="st">'t exist in `metadata`.Problem with `RFXSTDTC`, `RFXENDTC`, `RFICDTC`, `RFPENDTC`, `DTHDTC`, `ARMCD`, `ACTARMCD`, `ACTARM`, `COUNTRY`, `DMDTC`, `DMDY`, `TRTSDTM`, `TRTSTMF`, `TRTEDTM`, `TRTETMF`, `SCRFDT`, `EOSDT`, `FRVDT`, `RANDDT`, `DTHDT`, `DTHDTF`, `DTHADY`, `LDDTHELD`, `LSTALVDT`, `RACEGR1`, `REGION1`, `LDDTHGR1`, `DTH30FL`, `DTHA30FL`, and `DTHB30FL`</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="xportr_label">
<code>xportr_label()</code><a class="anchor" aria-label="anchor" href="#xportr_label"></a>
</h3>
<p>As you are creating your dataset in R you will often find that R
removes the label of your variable. Using <code><a href="../reference/xportr_label.html">xportr_label()</a></code>
you can easily re-apply all your labels to your variables in one quick
action.</p>
<p>For this example, we are going to manipulate both the metadata and
the <code>ADSL</code> dataset:</p>
<ul>
<li>The metadata will have the variable <code>TRTSDT</code> label be
greater than 40 characters.</li>
<li>The <code>ADSL</code> dataset will have all its labels stripped from
it.</li>
</ul>
<p>Remember in the length example, the labels were on the original
dataset as seen in the <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code> output.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_spec_lbl</span> <span class="op">&lt;-</span> <span class="va">var_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"TRTSDT"</span>,</span>
<span>    <span class="st">"Length of variable label must be 40 characters or less"</span>, <span class="va">label</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adsl_lbl</span> <span class="op">&lt;-</span> <span class="va">ADSL</span></span>
<span></span>
<span><span class="va">adsl_lbl</span> <span class="op">&lt;-</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/zap_label.html" class="external-link">zap_label</a></span><span class="op">(</span><span class="va">ADSL</span><span class="op">)</span></span></code></pre></div>
<p>We have successfully removed all the labels.</p>
<pre style="max-height: 300px;"><code>  tibble [306 × 51] (S3: tbl_df/tbl/data.frame)
   $ STUDYID : chr [1:306] "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" ...
   $ USUBJID : chr [1:306] "01-701-1015" "01-701-1023" "01-701-1028" "01-701-1033" ...
   $ SUBJID  : chr [1:306] "1015" "1023" "1028" "1033" ...
   $ RFSTDTC : chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
   $ RFENDTC : chr [1:306] "2014-07-02" "2012-09-02" "2014-01-14" "2014-04-14" ...
   $ RFXSTDTC: chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
   $ RFXENDTC: chr [1:306] "2014-07-02" "2012-09-01" "2014-01-14" "2014-03-31" ...
   $ RFICDTC : chr [1:306] NA NA NA NA ...
   $ RFPENDTC: chr [1:306] "2014-07-02T11:45" "2013-02-18" "2014-01-14T11:10" "2014-09-15" ...
   $ DTHDTC  : chr [1:306] NA NA NA NA ...
   $ DTHFL   : chr [1:306] NA NA NA NA ...
   $ SITEID  : chr [1:306] "701" "701" "701" "701" ...
   $ AGE     : num [1:306] 63 64 71 74 77 85 59 68 81 84 ...
   $ AGEU    : chr [1:306] "YEARS" "YEARS" "YEARS" "YEARS" ...
   $ SEX     : chr [1:306] "F" "M" "M" "M" ...
   $ RACE    : chr [1:306] "WHITE" "WHITE" "WHITE" "WHITE" ...
   $ ETHNIC  : chr [1:306] "HISPANIC OR LATINO" "HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" ...
   $ ARMCD   : chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
   $ ARM     : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
   $ ACTARMCD: chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
   $ ACTARM  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
   $ COUNTRY : chr [1:306] "USA" "USA" "USA" "USA" ...
   $ DMDTC   : chr [1:306] "2013-12-26" "2012-07-22" "2013-07-11" "2014-03-10" ...
   $ DMDY    : num [1:306] -7 -14 -8 -8 -7 -21 NA -9 -13 -7 ...
   $ TRT01P  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
   $ TRT01A  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
   $ TRTSDTM : POSIXct[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTSTMF : chr [1:306] "H" "H" "H" "H" ...
   $ TRTEDTM : POSIXct[1:306], format: "2014-07-02 23:59:59" "2012-09-01 23:59:59" ...
   $ TRTETMF : chr [1:306] "H" "H" "H" "H" ...
   $ TRTSDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTEDT  : Date[1:306], format: "2014-07-02" "2012-09-01" ...
   $ TRTDURD : num [1:306] 182 28 180 14 183 26 NA 190 10 55 ...
   $ SCRFDT  : Date[1:306], format: NA NA ...
   $ EOSDT   : Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ EOSSTT  : chr [1:306] "COMPLETED" "DISCONTINUED" "COMPLETED" "DISCONTINUED" ...
   $ FRVDT   : Date[1:306], format: NA "2013-02-18" ...
   $ RANDDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ DTHDT   : Date[1:306], format: NA NA ...
   $ DTHDTF  : chr [1:306] NA NA NA NA ...
   $ DTHADY  : num [1:306] NA NA NA NA NA NA NA NA NA NA ...
   $ LDDTHELD: num [1:306] NA NA NA NA NA NA NA NA NA NA ...
   $ LSTALVDT: Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ SAFFL   : chr [1:306] "Y" "Y" "Y" "Y" ...
   $ RACEGR1 : chr [1:306] "White" "White" "White" "White" ...
   $ AGEGR1  : chr [1:306] "18-64" "18-64" "&gt;64" "&gt;64" ...
   $ REGION1 : chr [1:306] "NA" "NA" "NA" "NA" ...
   $ LDDTHGR1: chr [1:306] NA NA NA NA ...
   $ DTH30FL : chr [1:306] NA NA NA NA ...
   $ DTHA30FL: chr [1:306] NA NA NA NA ...
   $ DTHB30FL: chr [1:306] NA NA NA NA ...
   - attr(*, "label")= chr "Demographics"</code></pre>
<p>Using <code><a href="../reference/xportr_label.html">xportr_label()</a></code> we will apply all the labels from
our metadata to the dataset. Please note again that we are using
<code>verbose = "warn"</code> and the same two issues for
<code>TRTDUR</code> and <code>DCREASCD</code> are reported as missing
from the metadata file. An additional message is sent around the
<code>TRTSDT</code> label having a length of greater than 40.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>adsl_lbl <span class="ot">&lt;-</span> <span class="fu">xportr_label</span>(<span class="at">.df =</span> adsl_lbl, <span class="at">metadata =</span> var_spec_lbl, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">verbose =</span> <span class="st">"warn"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  ── Variable labels missing from metadata. ──</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  ✔ <span class="dv">30</span> labels skipped</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  Warning<span class="sc">:</span> <span class="fu">Variable</span>(s) present <span class="cf">in</span> dataframe but doesn<span class="st">'t exist in `metadata`.</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="st">  ✖ Problem with `RFXSTDTC`, `RFXENDTC`, `RFICDTC`, `RFPENDTC`, `DTHDTC`, `ARMCD`, `ACTARMCD`, `ACTARM`, `COUNTRY`, `DMDTC`, `DMDY`, `TRTSDTM`, `TRTSTMF`, `TRTEDTM`, `TRTETMF`, `SCRFDT`, `EOSDT`, `FRVDT`, `RANDDT`, `DTHDT`, `DTHDTF`, `DTHADY`, `LDDTHELD`, `LSTALVDT`, `RACEGR1`, `REGION1`, `LDDTHGR1`, `DTH30FL`, `DTHA30FL`, and `DTHB30FL`</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="st">  Warning: Length of variable label must be 40 characters or less.</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="st">  ✖ Problem with `TRTSDT`.</span></span></code></pre></div>
<p>Success! All labels have been applied that are present in the both
the metadata and the dataset. However, please note that the
<code>TRTSDT</code> variable has had the label with characters greater
than 40 <strong>applied</strong> to the dataset and the
<code>TRTDUR</code> and <code>DCREASCD</code> have empty variable
labels.</p>
<pre style="max-height: 300px;"><code>  tibble [306 × 51] (S3: tbl_df/tbl/data.frame)
   $ STUDYID : chr [1:306] "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" ...
    ..- attr(*, "label")= chr "Study Identifier"
   $ USUBJID : chr [1:306] "01-701-1015" "01-701-1023" "01-701-1028" "01-701-1033" ...
    ..- attr(*, "label")= chr "Unique Subject Identifier"
   $ SUBJID  : chr [1:306] "1015" "1023" "1028" "1033" ...
    ..- attr(*, "label")= chr "Subject Identifier for the Study"
   $ RFSTDTC : chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Subject Reference Start Date/Time"
   $ RFENDTC : chr [1:306] "2014-07-02" "2012-09-02" "2014-01-14" "2014-04-14" ...
    ..- attr(*, "label")= chr "Subject Reference End Date/Time"
   $ RFXSTDTC: chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr ""
   $ RFXENDTC: chr [1:306] "2014-07-02" "2012-09-01" "2014-01-14" "2014-03-31" ...
    ..- attr(*, "label")= chr ""
   $ RFICDTC : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ RFPENDTC: chr [1:306] "2014-07-02T11:45" "2013-02-18" "2014-01-14T11:10" "2014-09-15" ...
    ..- attr(*, "label")= chr ""
   $ DTHDTC  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ DTHFL   : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Subject Died?"
   $ SITEID  : chr [1:306] "701" "701" "701" "701" ...
    ..- attr(*, "label")= chr "Study Site Identifier"
   $ AGE     : num [1:306] 63 64 71 74 77 85 59 68 81 84 ...
    ..- attr(*, "label")= chr "Age"
   $ AGEU    : chr [1:306] "YEARS" "YEARS" "YEARS" "YEARS" ...
    ..- attr(*, "label")= chr "Age Units"
   $ SEX     : chr [1:306] "F" "M" "M" "M" ...
    ..- attr(*, "label")= chr "Sex"
   $ RACE    : chr [1:306] "WHITE" "WHITE" "WHITE" "WHITE" ...
    ..- attr(*, "label")= chr "Race"
   $ ETHNIC  : chr [1:306] "HISPANIC OR LATINO" "HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" ...
    ..- attr(*, "label")= chr "Ethnicity"
   $ ARMCD   : chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr ""
   $ ARM     : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
   $ ACTARMCD: chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr ""
   $ ACTARM  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr ""
   $ COUNTRY : chr [1:306] "USA" "USA" "USA" "USA" ...
    ..- attr(*, "label")= chr ""
   $ DMDTC   : chr [1:306] "2013-12-26" "2012-07-22" "2013-07-11" "2014-03-10" ...
    ..- attr(*, "label")= chr ""
   $ DMDY    : num [1:306] -7 -14 -8 -8 -7 -21 NA -9 -13 -7 ...
    ..- attr(*, "label")= chr ""
   $ TRT01P  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Planned Treatment for Period 01"
   $ TRT01A  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Actual Treatment for Period 01"
   $ TRTSDTM : POSIXct[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTSTMF : chr [1:306] "H" "H" "H" "H" ...
    ..- attr(*, "label")= chr ""
   $ TRTEDTM : POSIXct[1:306], format: "2014-07-02 23:59:59" "2012-09-01 23:59:59" ...
   $ TRTETMF : chr [1:306] "H" "H" "H" "H" ...
    ..- attr(*, "label")= chr ""
   $ TRTSDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTEDT  : Date[1:306], format: "2014-07-02" "2012-09-01" ...
   $ TRTDURD : num [1:306] 182 28 180 14 183 26 NA 190 10 55 ...
    ..- attr(*, "label")= chr "Total Treatment Duration (Days)"
   $ SCRFDT  : Date[1:306], format: NA NA ...
   $ EOSDT   : Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ EOSSTT  : chr [1:306] "COMPLETED" "DISCONTINUED" "COMPLETED" "DISCONTINUED" ...
    ..- attr(*, "label")= chr "End of Study Status"
   $ FRVDT   : Date[1:306], format: NA "2013-02-18" ...
   $ RANDDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ DTHDT   : Date[1:306], format: NA NA ...
   $ DTHDTF  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ DTHADY  : num [1:306] NA NA NA NA NA NA NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ LDDTHELD: num [1:306] NA NA NA NA NA NA NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ LSTALVDT: Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ SAFFL   : chr [1:306] "Y" "Y" "Y" "Y" ...
    ..- attr(*, "label")= chr "Safety Population Flag"
   $ RACEGR1 : chr [1:306] "White" "White" "White" "White" ...
    ..- attr(*, "label")= chr ""
   $ AGEGR1  : chr [1:306] "18-64" "18-64" "&gt;64" "&gt;64" ...
    ..- attr(*, "label")= chr "Pooled Age Group 1"
   $ REGION1 : chr [1:306] "NA" "NA" "NA" "NA" ...
    ..- attr(*, "label")= chr ""
   $ LDDTHGR1: chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ DTH30FL : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ DTHA30FL: chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   $ DTHB30FL: chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr ""
   - attr(*, "label")= chr "Demographics"
   - attr(*, "_xportr.df_arg_")= chr "ADSL"</code></pre>
<p>Just like we did for the other functions, setting
<code>verbose = "stop"</code> immediately stops R from processing the
labels. Here the function detects the mismatches between the variables
and labels as well as the label that is greater than 40 characters. As
this stops the process, none of the labels will be applied to the
dataset until corrective action is applied.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>adsl_label <span class="ot">&lt;-</span> <span class="fu">xportr_label</span>(<span class="at">.df =</span> adsl_lbl, <span class="at">metadata =</span> var_spec_lbl, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">verbose =</span> <span class="st">"stop"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  ── Variable labels missing from metadata. ──</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  </span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  ✔ <span class="dv">30</span> labels skipped</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="st">`</span><span class="at">xportr_logger()</span><span class="st">`</span> at xportr<span class="sc">/</span>R<span class="sc">/</span>messages.R<span class="sc">:</span><span class="dv">172</span><span class="sc">:</span><span class="dv">5</span><span class="sc">:</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="sc">!</span> <span class="fu">Variable</span>(s) present <span class="cf">in</span> dataframe but doesn<span class="st">'t exist in `metadata`.</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="st">  ✖ Problem with `RFXSTDTC`, `RFXENDTC`, `RFICDTC`, `RFPENDTC`, `DTHDTC`, `ARMCD`, `ACTARMCD`, `ACTARM`, `COUNTRY`, `DMDTC`, `DMDY`, `TRTSDTM`, `TRTSTMF`, `TRTEDTM`, `TRTETMF`, `SCRFDT`, `EOSDT`, `FRVDT`, `RANDDT`, `DTHDT`, `DTHDTF`, `DTHADY`, `LDDTHELD`, `LSTALVDT`, `RACEGR1`, `REGION1`, `LDDTHGR1`, `DTH30FL`, `DTHA30FL`, and `DTHB30FL`</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="xportr_order">
<code>xportr_order()</code><a class="anchor" aria-label="anchor" href="#xportr_order"></a>
</h3>
<p>The order of the dataset can greatly increase readability of the
dataset for downstream stakeholders. For example, having all the
treatment related variables or analysis variables grouped together can
help with inspection and understanding of the dataset.
<code><a href="../reference/xportr_order.html">xportr_order()</a></code> can take the order information from the
metadata and apply it to your dataset.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>adsl_ord <span class="ot">&lt;-</span> <span class="fu">xportr_order</span>(<span class="at">.df =</span> ADSL, <span class="at">metadata =</span> var_spec, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">verbose =</span> <span class="st">"warn"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  ── <span class="dv">30</span> variables not <span class="cf">in</span> spec and moved to end ──</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  </span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  Warning<span class="sc">:</span> Variable moved to end <span class="cf">in</span> <span class="st">`</span><span class="at">.df</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>,</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>,</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>,</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  ── <span class="dv">42</span> reordered <span class="cf">in</span> dataset ──</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  Warning<span class="sc">:</span> Variable reordered <span class="cf">in</span> <span class="st">`</span><span class="at">.df</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">SITEID</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRT01P</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRT01A</span><span class="st">`</span>,</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  <span class="st">`</span><span class="at">TRTSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTDURD</span><span class="st">`</span>, <span class="st">`</span><span class="at">AGE</span><span class="st">`</span>, <span class="st">`</span><span class="at">AGEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">AGEU</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACE</span><span class="st">`</span>, <span class="st">`</span><span class="at">ETHNIC</span><span class="st">`</span>,</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="st">`</span><span class="at">SAFFL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHFL</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSSTT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>,</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>,</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>,</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, and</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span></span></code></pre></div>
<p>Readers are encouraged to inspect the dataset and metadata to see the
past order and updated order after calling the function. Note the
messaging from <code><a href="../reference/xportr_order.html">xportr_order()</a></code>:</p>
<ul>
<li>Variables not in the metadata are moved to the end</li>
<li>Variables not in order are re-ordered and a message is printed out
on which ones were re-ordered.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>adsl_ord <span class="ot">&lt;-</span> <span class="fu">xportr_order</span>(<span class="at">.df =</span> ADSL, <span class="at">metadata =</span> var_spec, <span class="at">domain =</span> <span class="st">"ADSL"</span>, <span class="at">verbose =</span> <span class="st">"stop"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  ── <span class="dv">30</span> variables not <span class="cf">in</span> spec and moved to end ──</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  </span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="st">`</span><span class="at">xportr_logger()</span><span class="st">`</span> at xportr<span class="sc">/</span>R<span class="sc">/</span>messages.R<span class="sc">:</span><span class="dv">199</span><span class="sc">:</span><span class="dv">5</span><span class="sc">:</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="sc">!</span> Variable moved to end <span class="cf">in</span> <span class="st">`</span><span class="at">.df</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span></code></pre></div>
<p>Just like we did for the other functions, setting
<code>verbose = "stop"</code> immediately stops R from processing the
order. If variables or metadata are missing from either, the re-ordering
will not process until corrective action is performed.</p>
</div>
<div class="section level3">
<h3 id="xportr_format">
<code>xportr_format()</code><a class="anchor" aria-label="anchor" href="#xportr_format"></a>
</h3>
<p>Formats play an important role in the SAS language and have a column
in specification files. Being able to easily apply formats into your
<code>xpt</code> file will allow downstream users of SAS to quickly
format the data appropriately when reading into a SAS-based system.
<code><a href="../reference/xportr_format.html">xportr_format()</a></code> can take these formats and apply them.
Please reference <code><a href="../reference/xportr_length.html">xportr_length()</a></code> or
<code><a href="../reference/xportr_label.html">xportr_label()</a></code> to note the missing <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code> for
formats in our <code>ADSL</code> dataset.</p>
<p>This example is slightly different from previous examples. You will
need to use <code><a href="../reference/xportr_type.html">xportr_type()</a></code> to coerce R Date variables and
others types to character or numeric. Only then can you use
<code><a href="../reference/xportr_format.html">xportr_format()</a></code> to apply the format column to the
dataset.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adsl_fmt</span> <span class="op">&lt;-</span> <span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_type.html">xportr_type</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="va">var_spec</span>, domain <span class="op">=</span> <span class="st">"ADSL"</span>, verbose <span class="op">=</span> <span class="st">"warn"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_format.html">xportr_format</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="va">var_spec</span>, domain <span class="op">=</span> <span class="st">"ADSL"</span><span class="op">)</span></span></code></pre></div>
<p>Success! We have taken the metadata formats and applied them to the
dataset. Please inspect variables like <code>TRTSDT</code> or
<code>DISONSDT</code> to see the <code>DATE9.</code> format being
applied.</p>
<pre style="max-height: 300px;"><code>  tibble [306 × 51] (S3: tbl_df/tbl/data.frame)
   $ STUDYID : chr [1:306] "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" "CDISCPILOT01" ...
    ..- attr(*, "label")= chr "Study Identifier"
    ..- attr(*, "format.sas")= chr ""
   $ USUBJID : chr [1:306] "01-701-1015" "01-701-1023" "01-701-1028" "01-701-1033" ...
    ..- attr(*, "label")= chr "Unique Subject Identifier"
    ..- attr(*, "format.sas")= chr ""
   $ SUBJID  : chr [1:306] "1015" "1023" "1028" "1033" ...
    ..- attr(*, "label")= chr "Subject Identifier for the Study"
    ..- attr(*, "format.sas")= chr ""
   $ RFSTDTC : chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Subject Reference Start Date/Time"
    ..- attr(*, "format.sas")= chr ""
   $ RFENDTC : chr [1:306] "2014-07-02" "2012-09-02" "2014-01-14" "2014-04-14" ...
    ..- attr(*, "label")= chr "Subject Reference End Date/Time"
    ..- attr(*, "format.sas")= chr ""
   $ RFXSTDTC: chr [1:306] "2014-01-02" "2012-08-05" "2013-07-19" "2014-03-18" ...
    ..- attr(*, "label")= chr "Date/Time of First Study Treatment"
    ..- attr(*, "format.sas")= chr ""
   $ RFXENDTC: chr [1:306] "2014-07-02" "2012-09-01" "2014-01-14" "2014-03-31" ...
    ..- attr(*, "label")= chr "Date/Time of Last Study Treatment"
    ..- attr(*, "format.sas")= chr ""
   $ RFICDTC : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Date/Time of Informed Consent"
    ..- attr(*, "format.sas")= chr ""
   $ RFPENDTC: chr [1:306] "2014-07-02T11:45" "2013-02-18" "2014-01-14T11:10" "2014-09-15" ...
    ..- attr(*, "label")= chr "Date/Time of End of Participation"
    ..- attr(*, "format.sas")= chr ""
   $ DTHDTC  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Date/Time of Death"
    ..- attr(*, "format.sas")= chr ""
   $ DTHFL   : chr [1:306] NA NA NA NA ...
    ..- attr(*, "label")= chr "Subject Death Flag"
    ..- attr(*, "format.sas")= chr ""
   $ SITEID  : chr [1:306] "701" "701" "701" "701" ...
    ..- attr(*, "label")= chr "Study Site Identifier"
    ..- attr(*, "format.sas")= chr ""
   $ AGE     : num [1:306] 63 64 71 74 77 85 59 68 81 84 ...
    ..- attr(*, "label")= chr "Age"
    ..- attr(*, "format.sas")= chr ""
   $ AGEU    : chr [1:306] "YEARS" "YEARS" "YEARS" "YEARS" ...
    ..- attr(*, "label")= chr "Age Units"
    ..- attr(*, "format.sas")= chr ""
   $ SEX     : chr [1:306] "F" "M" "M" "M" ...
    ..- attr(*, "label")= chr "Sex"
    ..- attr(*, "format.sas")= chr ""
   $ RACE    : chr [1:306] "WHITE" "WHITE" "WHITE" "WHITE" ...
    ..- attr(*, "label")= chr "Race"
    ..- attr(*, "format.sas")= chr ""
   $ ETHNIC  : chr [1:306] "HISPANIC OR LATINO" "HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" "NOT HISPANIC OR LATINO" ...
    ..- attr(*, "label")= chr "Ethnicity"
    ..- attr(*, "format.sas")= chr ""
   $ ARMCD   : chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr "Planned Arm Code"
    ..- attr(*, "format.sas")= chr ""
   $ ARM     : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
    ..- attr(*, "format.sas")= chr ""
   $ ACTARMCD: chr [1:306] "Pbo" "Pbo" "Xan_Hi" "Xan_Lo" ...
    ..- attr(*, "label")= chr "Actual Arm Code"
    ..- attr(*, "format.sas")= chr ""
   $ ACTARM  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Actual Arm"
    ..- attr(*, "format.sas")= chr ""
   $ COUNTRY : chr [1:306] "USA" "USA" "USA" "USA" ...
    ..- attr(*, "label")= chr "Country"
    ..- attr(*, "format.sas")= chr ""
   $ DMDTC   : chr [1:306] "2013-12-26" "2012-07-22" "2013-07-11" "2014-03-10" ...
    ..- attr(*, "label")= chr "Date/Time of Collection"
    ..- attr(*, "format.sas")= chr ""
   $ DMDY    : num [1:306] -7 -14 -8 -8 -7 -21 NA -9 -13 -7 ...
    ..- attr(*, "label")= chr "Study Day of Collection"
    ..- attr(*, "format.sas")= chr ""
   $ TRT01P  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Planned Arm"
    ..- attr(*, "format.sas")= chr ""
   $ TRT01A  : chr [1:306] "Placebo" "Placebo" "Xanomeline High Dose" "Xanomeline Low Dose" ...
    ..- attr(*, "label")= chr "Description of Actual Arm"
    ..- attr(*, "format.sas")= chr ""
   $ TRTSDTM : POSIXct[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTSTMF : chr [1:306] "H" "H" "H" "H" ...
    ..- attr(*, "format.sas")= chr ""
   $ TRTEDTM : POSIXct[1:306], format: "2014-07-02 23:59:59" "2012-09-01 23:59:59" ...
   $ TRTETMF : chr [1:306] "H" "H" "H" "H" ...
    ..- attr(*, "format.sas")= chr ""
   $ TRTSDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ TRTEDT  : Date[1:306], format: "2014-07-02" "2012-09-01" ...
   $ TRTDURD : num [1:306] 182 28 180 14 183 26 NA 190 10 55 ...
    ..- attr(*, "format.sas")= chr ""
   $ SCRFDT  : Date[1:306], format: NA NA ...
   $ EOSDT   : Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ EOSSTT  : chr [1:306] "COMPLETED" "DISCONTINUED" "COMPLETED" "DISCONTINUED" ...
    ..- attr(*, "format.sas")= chr ""
   $ FRVDT   : Date[1:306], format: NA "2013-02-18" ...
   $ RANDDT  : Date[1:306], format: "2014-01-02" "2012-08-05" ...
   $ DTHDT   : Date[1:306], format: NA NA ...
   $ DTHDTF  : chr [1:306] NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   $ DTHADY  : num [1:306] NA NA NA NA NA NA NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   $ LDDTHELD: num [1:306] NA NA NA NA NA NA NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   $ LSTALVDT: Date[1:306], format: "2014-07-02" "2012-09-02" ...
   $ SAFFL   : chr [1:306] "Y" "Y" "Y" "Y" ...
    ..- attr(*, "format.sas")= chr ""
   $ RACEGR1 : chr [1:306] "White" "White" "White" "White" ...
    ..- attr(*, "format.sas")= chr ""
   $ AGEGR1  : chr [1:306] "18-64" "18-64" "&gt;64" "&gt;64" ...
    ..- attr(*, "format.sas")= chr ""
   $ REGION1 : chr [1:306] "NA" "NA" "NA" "NA" ...
    ..- attr(*, "format.sas")= chr ""
   $ LDDTHGR1: chr [1:306] NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   $ DTH30FL : chr [1:306] NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   $ DTHA30FL: chr [1:306] NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   $ DTHB30FL: chr [1:306] NA NA NA NA ...
    ..- attr(*, "format.sas")= chr ""
   - attr(*, "label")= chr "Demographics"
   - attr(*, "_xportr.df_arg_")= chr "ADSL"</code></pre>
<p>At the time of <code>{xportr} v0.3.0</code> we have not implemented
any warnings or error messaging for this function. However,
<code><a href="../reference/xportr_write.html">xportr_write()</a></code> through <code><a href="../reference/xpt_validate.html">xpt_validate()</a></code> will
check that formats applied are valid SAS formats.</p>
</div>
<div class="section level3">
<h3 id="xportr_write">
<code>xportr_write()</code><a class="anchor" aria-label="anchor" href="#xportr_write"></a>
</h3>
<p>Finally, we want to write out an <code>xpt</code> dataset with all
our metadata applied.</p>
<p>We will make use of <code><a href="../reference/metadata.html">xportr_metadata()</a></code> to reduce
repetitive metadata and domain specifications. We will use default
option for verbose, which is just <code>message</code> and so not set
anything for <code>verbose</code>. In <code><a href="../reference/xportr_write.html">xportr_write()</a></code> we
will specify the path, which will just be our current working directory,
set the dataset label and toggle the <code>strict_checks</code> to be
<code>FALSE</code>. It is also note worthy that you can set the dataset
label using the <code>xportr_df_label</code> and a
<code>dataset_spec</code> which will be used by the
<code><a href="../reference/xportr_write.html">xportr_write()</a></code></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>ADSL <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">xportr_metadata</span>(var_spec, <span class="st">"ADSL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">xportr_type</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">xportr_length</span>(<span class="at">length_source =</span> <span class="st">"metadata"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="fu">xportr_label</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="fu">xportr_order</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  <span class="fu">xportr_format</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  <span class="fu">xportr_df_label</span>(dataset_spec) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="fu">xportr_write</span>(<span class="at">path =</span> <span class="st">"adsl.xpt"</span>, <span class="at">strict_checks =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  </span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>  ── Variable lengths missing from metadata. ──</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  </span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  ✔ <span class="dv">30</span> lengths resolved <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  </span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>  ── Variable labels missing from metadata. ──</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>  </span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>  ✔ <span class="dv">30</span> labels skipped</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  </span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>  ── <span class="dv">30</span> variables not <span class="cf">in</span> spec and moved to end ──</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>  </span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>  ── <span class="dv">42</span> reordered <span class="cf">in</span> dataset ──</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>  </span></code></pre></div>
<p>Success! We have applied types, lengths, labels, ordering and formats
to our dataset. Note the messages written out to the console. Remember
the <code>TRTDUR</code> and <code>DCREASCD</code> and how these are not
present in the metadata, but in the dataset. This impacts the messaging
for lengths and labels where <a href="https://atorus-research.github.io/xportr/">xportr</a> is printing out some
feedback to us on the two issues. 5 types are coerced, as well as 36
variables re-ordered. Note that <code>strict_checks</code> was set to
<code>FALSE</code>.</p>
<p>The next two examples showcase the <code>strict_checks = TRUE</code>
option in <code><a href="../reference/xportr_write.html">xportr_write()</a></code> where we will look at formats and
labels.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ADSL</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/xportr_write.html">xportr_write</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"adsl.xpt"</span>, metadata <span class="op">=</span> <span class="va">dataset_spec</span>, domain <span class="op">=</span> <span class="st">"ADSL"</span>, strict_checks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As there at several <code>---DT</code> type variables,
<code><a href="../reference/xportr_write.html">xportr_write()</a></code> detects the lack of formats being applied.
To correct this remember you can use <code><a href="../reference/xportr_type.html">xportr_type()</a></code> and
<code><a href="../reference/xportr_format.html">xportr_format()</a></code> to apply formats to your xpt dataset.</p>
<p>Below we have manipulated the labels to again be greater than 40
characters for <code>TRTSDT</code>. We have turned off
<code><a href="../reference/xportr_label.html">xportr_label()</a></code> verbose options to only produce a message.
However, <code><a href="../reference/xportr_write.html">xportr_write()</a></code> with
<code>strict_checks = TRUE</code> will error out as this is one of the
many <code><a href="../reference/xpt_validate.html">xpt_validate()</a></code> checks going on behind the scenes.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>var_spec_lbl <span class="ot">&lt;-</span> var_spec <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">if_else</span>(variable <span class="sc">==</span> <span class="st">"TRTSDT"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>    <span class="st">"Length of variable label must be 40 characters or less"</span>, label</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  ))</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>ADSL <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="fu">xportr_metadata</span>(var_spec_lbl, <span class="st">"ADSL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="fu">xportr_label</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="fu">xportr_type</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="fu">xportr_format</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>  <span class="fu">xportr_df_label</span>(dataset_spec) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>  <span class="fu">xportr_write</span>(<span class="at">path =</span> <span class="st">"adsl.xpt"</span>, <span class="at">strict_checks =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  ── Variable labels missing from metadata. ──</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  </span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  ✔ <span class="dv">30</span> labels skipped</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  Warning<span class="sc">:</span> Length of variable label must be <span class="dv">40</span> characters or less.</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  ✖ Problem with <span class="st">`</span><span class="at">TRTSDT</span><span class="st">`</span>.</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  Error <span class="cf">in</span> <span class="st">`</span><span class="at">xportr_write()</span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>  <span class="sc">!</span> The following validation checks failed<span class="sc">:</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>  • Label <span class="st">'TRTSDT=Length of variable label must be 40 characters or less'</span> must be <span class="dv">40</span> characters or less.</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="xportr">
<code>xportr()</code><a class="anchor" aria-label="anchor" href="#xportr"></a>
</h3>
<p>Too many functions to call? Simplify with <code><a href="../reference/xportr.html">xportr()</a></code>. It
bundles all core <code>xportr</code> functions for writing to
<code>xpt</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">xportr</span>(</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  ADSL,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="at">var_metadata =</span> var_spec,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="at">df_metadata =</span> dataset_spec,</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="at">domain =</span> <span class="st">"ADSL"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="st">"none"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"adsl.xpt"</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  </span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  ── Variable lengths missing from metadata. ──</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  </span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>  ✔ <span class="dv">30</span> lengths resolved <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  </span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>  ── Variable labels missing from metadata. ──</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>  </span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>  ✔ <span class="dv">30</span> labels skipped</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>  </span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>  ── <span class="dv">30</span> variables not <span class="cf">in</span> spec and moved to end ──</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>  </span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>  ── <span class="dv">42</span> reordered <span class="cf">in</span> dataset ──</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>  </span></code></pre></div>
<p><code><a href="../reference/xportr.html">xportr()</a></code> is equivalent to calling the following
functions individually:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>ADSL <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">xportr_metadata</span>(var_spec, <span class="st">"ADSL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">xportr_type</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">xportr_length</span>(<span class="at">length_source =</span> <span class="st">"metadata"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="fu">xportr_label</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="fu">xportr_order</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="fu">xportr_format</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="fu">xportr_df_label</span>(dataset_spec) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  <span class="fu">xportr_write</span>(<span class="at">path =</span> <span class="st">"adsl.xpt"</span>, <span class="at">strict_checks =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  ── Variable lengths missing from metadata. ──</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  </span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>  ✔ <span class="dv">30</span> lengths resolved <span class="st">`</span><span class="at">RFXSTDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFXENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFICDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">RFPENDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">ARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARMCD</span><span class="st">`</span>, <span class="st">`</span><span class="at">ACTARM</span><span class="st">`</span>, <span class="st">`</span><span class="at">COUNTRY</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDTC</span><span class="st">`</span>, <span class="st">`</span><span class="at">DMDY</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTSTMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTEDTM</span><span class="st">`</span>, <span class="st">`</span><span class="at">TRTETMF</span><span class="st">`</span>, <span class="st">`</span><span class="at">SCRFDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">EOSDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">FRVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RANDDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHDTF</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHADY</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHELD</span><span class="st">`</span>, <span class="st">`</span><span class="at">LSTALVDT</span><span class="st">`</span>, <span class="st">`</span><span class="at">RACEGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">REGION1</span><span class="st">`</span>, <span class="st">`</span><span class="at">LDDTHGR1</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTH30FL</span><span class="st">`</span>, <span class="st">`</span><span class="at">DTHA30FL</span><span class="st">`</span>, and <span class="st">`</span><span class="at">DTHB30FL</span><span class="st">`</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>  </span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  ── Variable labels missing from metadata. ──</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  </span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>  ✔ <span class="dv">30</span> labels skipped</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>  </span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>  ── <span class="dv">30</span> variables not <span class="cf">in</span> spec and moved to end ──</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>  </span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>  ── <span class="dv">42</span> reordered <span class="cf">in</span> dataset ──</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>  </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="future-work">Future Work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h3>
<p><a href="https://atorus-research.github.io/xportr/">xportr</a> is still undergoing development. We hope to
produce more vignettes and functions that will allow users to bulk
process multiple datasets as well as have examples of piping
<code>xpt</code> files and related documentation to a validation
software service. As always, please let us know of any feature requests,
documentation updates or bugs on <a href="https://github.com/Atorus-Research/xportr/issues" class="external-link">our GitHub
repo</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eli Miller, Ben Straub, Zelos Zhu, Ethan Brockmann, Vedha Viyash, Andre Verissimo, Sophie Shapcott, Celine Piraux, Kangjie Zhang, Adrian Chan, Sadchla Mascary.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
